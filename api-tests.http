### E-commerce Starter API Tests
### Documentation: http://localhost:3000/docs

# Variables globales
@baseUrl = http://localhost:3001/api
@testUserId = cmf03lyk50001ksfqur046yqg
@testVariantId = cmf03bww50008ksfsjjm4mfxj
@testVariantId2 = cmf03bww5000aksfshvhagj6x

###
# ğŸ§ª STEP 1: CrÃ©er des donnÃ©es de test
POST {{baseUrl}}/test-data
Content-Type: application/json

###
# ğŸ‘¤ USERS - CrÃ©er un utilisateur
POST {{baseUrl}}/users
Content-Type: application/json

{
  "email": "john.doe@example.com",
  "name": "John Doe",
  "role": "CLIENT"
}

###
# ğŸ‘¤ USERS - RÃ©cupÃ©rer un utilisateur (remplacez l'ID)
GET {{baseUrl}}/users/{{testUserId}}

###
# ğŸ‘¤ USERS - Modifier un utilisateur
PUT {{baseUrl}}/users/{{testUserId}}
Content-Type: application/json

{
  "name": "John Smith",
  "email": "john.smith@example.com"
}

###
# ğŸ  ADDRESSES - Ajouter une adresse
POST {{baseUrl}}/users/{{testUserId}}/addresses
Content-Type: application/json

{
  "street": "456 Boulevard Saint-Laurent",
  "city": "MontrÃ©al",
  "state": "QC",
  "zipCode": "H2X 2T1",
  "country": "CA",
  "type": "SHIPPING",
  "isDefault": true
}

###
# ğŸ“‚ CATEGORIES - Liste des catÃ©gories (EN)
GET {{baseUrl}}/categories?language=EN

###
# ğŸ“‚ CATEGORIES - Liste des catÃ©gories (FR)
GET {{baseUrl}}/categories?language=FR

###
# ğŸ“‚ CATEGORIES - CatÃ©gorie par slug (EN)
GET {{baseUrl}}/categories/electronics?language=EN

###
# ğŸ“‚ CATEGORIES - CatÃ©gorie par slug (FR)
GET {{baseUrl}}/categories/electronics?language=FR

###
# ğŸ›ï¸ PRODUCTS - Liste des produits (EN)
GET {{baseUrl}}/products?language=EN

###
# ğŸ›ï¸ PRODUCTS - Liste des produits (FR)
GET {{baseUrl}}/products?language=FR

###
# ğŸ›ï¸ PRODUCTS - Recherche de produits
GET {{baseUrl}}/products?search=iPhone&language=FR

###
# ğŸ›ï¸ PRODUCTS - Produit par slug (EN)
GET {{baseUrl}}/products/iphone-15?language=EN

###
# ğŸ›ï¸ PRODUCTS - Produit par slug (FR)
GET {{baseUrl}}/products/iphone-15?language=FR

###
# ğŸ›’ CART - RÃ©cupÃ©rer le panier
GET {{baseUrl}}/cart/{{testUserId}}

###
# ğŸ›’ CART - Ajouter au panier (utilisez l'ID de variante des donnÃ©es de test)
POST {{baseUrl}}/cart/{{testUserId}}
Content-Type: application/json

{
  "variantId": "{{testVariantId}}",
  "quantity": 2
}

###
# ğŸ›’ CART - Ajouter un autre produit au panier
POST {{baseUrl}}/cart/{{testUserId}}
Content-Type: application/json

{
  "variantId": "cm5var789",
  "quantity": 1
}

###
# ğŸ“¦ ORDERS - CrÃ©er une commande depuis le panier
POST {{baseUrl}}/orders
Content-Type: application/json

{
  "userId": "{{testUserId}}",
  "shippingAddress": {
    "street": "123 Rue Test",
    "city": "MontrÃ©al", 
    "state": "QC",
    "zipCode": "H3B 1A1",
    "country": "CA"
  },
  "billingAddress": {
    "street": "123 Rue Test",
    "city": "MontrÃ©al",
    "state": "QC", 
    "zipCode": "H3B 1A1",
    "country": "CA"
  }
}

###
# ğŸ“¦ ORDERS - RÃ©cupÃ©rer une commande (remplacez l'ID)
@testOrderId = cm5order123
GET {{baseUrl}}/orders/{{testOrderId}}

###
# ğŸ“¦ ORDERS - Modifier le statut d'une commande
PATCH {{baseUrl}}/orders/{{testOrderId}}
Content-Type: application/json

{
  "status": "PAID"
}

###
# ğŸ“‹ USER ORDERS - Commandes d'un utilisateur
GET {{baseUrl}}/users/{{testUserId}}/orders

###
# ğŸ“‹ USER ORDERS - Commandes d'un utilisateur avec pagination
GET {{baseUrl}}/users/{{testUserId}}/orders?limit=5&offset=0

###
# âŒ TESTS D'ERREUR - Utilisateur inexistant
GET {{baseUrl}}/users/inexistant-id

###
# âŒ TESTS D'ERREUR - Produit inexistant
GET {{baseUrl}}/products/produit-inexistant

###
# âŒ TESTS D'ERREUR - Ajouter au panier sans variantId
POST {{baseUrl}}/cart/{{testUserId}}
Content-Type: application/json

{
  "quantity": 2
}

###
# âŒ TESTS D'ERREUR - QuantitÃ© nÃ©gative
POST {{baseUrl}}/cart/{{testUserId}}
Content-Type: application/json

{
  "variantId": "{{testVariantId}}",
  "quantity": -1
}

###
# ğŸŒ TESTS MULTILINGUES - Produits en diffÃ©rentes langues
GET {{baseUrl}}/products?language=ES

###
GET {{baseUrl}}/products?language=DE

###
GET {{baseUrl}}/products?language=IT

###
# ğŸ” TESTS DE RECHERCHE - DiffÃ©rents termes
GET {{baseUrl}}/products?search=phone&language=EN

###
GET {{baseUrl}}/products?search=tÃ©lÃ©phone&language=FR

###
# ğŸ“Š WORKFLOW COMPLET E-COMMERCE
# 1. CrÃ©er utilisateur â†’ 2. Ajouter au panier â†’ 3. CrÃ©er commande

# Ã‰tape 1: CrÃ©er utilisateur
POST {{baseUrl}}/users
Content-Type: application/json

{
  "email": "workflow@test.com",
  "name": "Workflow Test"
}

### 
# Ã‰tape 2: Ajouter des produits au panier (utilisez l'ID utilisateur crÃ©Ã©)
@workflowUserId = REMPLACER_PAR_ID_UTILISATEUR_CREE
POST {{baseUrl}}/cart/{{workflowUserId}}
Content-Type: application/json

{
  "variantId": "REMPLACER_PAR_ID_VARIANTE",
  "quantity": 1
}

###
# Ã‰tape 3: VÃ©rifier le panier
GET {{baseUrl}}/cart/{{workflowUserId}}

###
# Ã‰tape 4: CrÃ©er la commande
POST {{baseUrl}}/orders
Content-Type: application/json

{
  "userId": "{{workflowUserId}}",
  "shippingAddress": {
    "street": "789 Test Avenue",
    "city": "QuÃ©bec",
    "state": "QC",
    "zipCode": "G1K 3X1", 
    "country": "CA"
  },
  "billingAddress": {
    "street": "789 Test Avenue",
    "city": "QuÃ©bec",
    "state": "QC",
    "zipCode": "G1K 3X1",
    "country": "CA"
  }
}
